!function(u){function e(e){for(var t,n,r=e[0],a=e[1],l=e[2],o=e[3]||[],i=0,c=[];i<r.length;i++)n=r[i],p[n]&&c.push(p[n][0]),p[n]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(u[t]=a[t]);for(h&&h(e),o.forEach(function(e){if(void 0===p[e]){p[e]=null;var t=document.createElement("link");f.nc&&t.setAttribute("nonce",f.nc),t.rel="prefetch",t.as="script",t.href=d(e),document.head.appendChild(t)}});c.length;)c.shift()();return m.push.apply(m,l||[]),s()}function s(){for(var e,t=0;t<m.length;t++){for(var n=m[t],r=!0,a=1;a<n.length;a++){var l=n[a];0!==p[l]&&(r=!1)}r&&(m.splice(t--,1),e=f(f.s=n[0]))}return e}var n={},p={0:0},m=[];function d(e){return f.p+""+({}[e]||e)+"-"+{2:"181fbf05cadd7ae7d0a4",3:"62e15864344727aaa217"}[e]+".js"}function f(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return u[e].call(t.exports,t,t.exports,f),t.l=!0,t.exports}f.e=function(l){var e=[],n=p[l];if(0!==n)if(n)e.push(n[2]);else{var t=new Promise(function(e,t){n=p[l]=[e,t]});e.push(n[2]=t);var r,o=document.createElement("script");o.charset="utf-8",o.timeout=120,f.nc&&o.setAttribute("nonce",f.nc),o.src=d(l),r=function(e){o.onerror=o.onload=null,clearTimeout(i);var t=p[l];if(0!==t){if(t){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,a=new Error("Loading chunk "+l+" failed.\n("+n+": "+r+")");a.type=n,a.request=r,t[1](a)}p[l]=void 0}};var i=setTimeout(function(){r({type:"timeout",target:o})},12e4);o.onerror=o.onload=r,document.head.appendChild(o)}return Promise.all(e)},f.m=u,f.c=n,f.d=function(e,t,n){f.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},f.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.t=function(t,e){if(1&e&&(t=f(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(f.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)f.d(n,r,function(e){return t[e]}.bind(null,r));return n},f.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(t,"a",t),t},f.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f.p="",f.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],r=t.push.bind(t);t.push=e,t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var h=r;e([[],{},0,[2,3]]),m.push([43,1]),s()}({42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(0),v=n.n(r),a=n(20),l=n(2),o=n(23),i=n(8),c="ADD_PLAYER",u="ADD_MATCH",s="EDIT_MATCH",p="ADD_LEAGUE",m="RECEIVE_PLAYERS",d="RECEIVE_MATCHES",f="RECEIVE_ELO_ENTRIES",h="RECEIVE_SPORTS",y="SET_LEAGUE",b="RECEIVE_LEAGUES",g="SIGN_IN",E="SIGN_OUT",w="JOINED_LEAGUE",_="LOADING_BEGIN",O="LOADING_COMPLETE",C="LOADING_FAIL",j=function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{headers:{}},a=arguments[2],l=arguments[3];return new Promise(function(t,n){l({type:_,payload:e}),a&&(r.headers["League-Id"]=a().leagues.current),fetch(e,r).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(e){!1!==n(e)&&l({type:C,error:e})}).then(function(){return l({type:O,payload:e})})})},N=function(e,t,n,r){return j(e,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)},n,r)},S=function(n,r,a){return function(){return function(e,t){return j(n,void 0,t,e).then(r.bind(null,e),a||function(e){return console.error(e)})}}},I=S("/api/elo_entries",function(e,t){return e({type:f,payload:t})}),k=S("/api/players",function(e,t){return e({type:m,payload:t})}),P=function(n){return function(t,e){return N("/api/players",n,e,t).then(function(e){return t({type:c,payload:e})},function(e){return console.error(e)})}},x=S("/api/matches",function(e,t){return e(L(t))}),L=function(e){return{type:d,payload:e}},A=function(e){return{type:s,payload:e}},T=function(n){return function(t,e){return N("/api/matches",n,e,t).then(function(e){n.created_at?t(x()):t({type:u,payload:e}),t(k()),t(I())},function(e){return console.error(e)})}},M=function(o){return function(t,e){return(n="/api/matches/"+o.id,r=o,a=e,l=t,j(n,{method:"PUT",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(r)},a,l)).then(function(e){t(x()),t(k()),t(I())},function(e){return console.error(e)});var n,r,a,l}},D=function(e){return{type:w,payload:e}},R=function(t){return function(e){window.localStorage.setItem("leagueId",t),e({type:y,payload:t}),e(k()),e(x()),e(I())}},U=S("/api/leagues",function(e,t){return e({type:b,payload:t})}),H=function(n){return function(t,e){return N("/api/leagues",n,e,t).then(function(e){t({type:p,payload:e}),t(D({league_id:e.id,role:"admin"}))},function(e){return console.error(e)})}},G=S("/api/sports",function(e,t){return e({type:h,payload:t})}),W=function(e){return{type:g,payload:e}},q=S("/api/users/me",function(e,t){return e(W(t))},function(e){return!1});var z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function J(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Y=Object(i.c)({players:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case c:return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e),[t.payload]).sort(function(e,t){return t.elo-e.elo});case m:return t.payload;case y:return null;default:return e}},matches:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case d:return z({},e,{all:t.payload});case u:return z({},e,{all:[t.payload].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.all))});case y:return{};case s:return z({},e,{currentlyEditing:t.payload});case E:return z({},e,{currentlyEditing:null});default:return e}},userContext:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case g:return V({},e,{currentUser:t.payload});case E:return V({},e,{currentUser:null});default:return e}},eloEntries:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case f:return t.payload.map(function(e){return e.created_at=new Date(e.created_at),e});case y:return null;default:return e}},leagues:function(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],a=n;switch(r.type){case b:a=B({},n,{all:r.payload});break;case p:a=B({},n,{all:[].concat(J(n.all),[r.payload])});break;case y:a=B({},n,{current:r.payload});break;case g:a=B({},n,{memberships:r.payload.league_memberships});break;case E:a=B({},n,{memberships:null});break;case w:a=B({},n,{memberships:[].concat(J(n.memberships),[r.payload])})}return a.currentMembership=(t=a.current,e=a.memberships,t&&e&&e.find(function(e){return e.league_id==t})),a},loading:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{numPending:0,error:null},t=arguments[1];switch(t.type){case _:return F({},e,{numPending:e.numPending+1});case C:return F({},e,{error:t.payload});case O:return F({},e,{numPending:e.numPending-1});default:return e}},sports:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case h:return t.payload;default:return e}}}),K=Object(i.d)(Y,Object(i.a)(o.a)),Q=window.localStorage.getItem("leagueId");K.dispatch(U()),K.dispatch(q()),Q&&K.dispatch(R(Number(Q)));var X=K,Z=n(49),$=n(24),ee=n(48),te=n(47),ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var re=function(e){var t=e.component,n=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["component"]);return v.a.createElement($.a,ne({},n,{component:Object(l.b)(function(e){return{leagueId:e.leagues.current}})(function(e){return null!=e.leagueId?v.a.createElement(t,e):v.a.createElement(te.a,{to:{pathname:"/leagues",state:{from:e.location}}})})}))},ae=function(e){var t=e.children,n=e.description;return v.a.createElement("div",{className:"field"},v.a.createElement("label",{className:"label"},n,t))},le=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var oe={name:"",elo:1500},ie=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=oe,e.handleChange=e.handleChange.bind(e),e.handleSubmit=e.handleSubmit.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),le(t,[{key:"handleChange",value:function(e){var t,n,r;this.setState((t={},n=e.target.name,r=e.target.value,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.createPlayer({name:this.state.name,elo:parseInt(this.state.elo)}),this.setState(oe)}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.elo;return v.a.createElement("form",{onSubmit:this.handleSubmit},v.a.createElement(ae,{description:"Name"},v.a.createElement("input",{type:"text",className:"input is-primary",name:"name",placeholder:"Enter the player's name",value:t,onChange:this.handleChange})),v.a.createElement(ae,{description:"Initial Elo"},v.a.createElement("input",{type:"number",className:"input is-primary",name:"elo",placeholder:"Enter the player's starting Elo score",value:n,disabled:"disabled",onChange:this.handleChange})),v.a.createElement("button",{type:"submit",className:"button is-primary"},"Create Player"))}}]),t}(),ce=Object(l.b)(null,function(t){return{createPlayer:function(e){return t(P(e))}}})(ie),ue=n(16),se=Object(l.b)(function(e){return{players:e.players,user:e.userContext.currentUser}})(function(e){var c=e.players,u=e.user;return null==c?v.a.createElement("div",null,"Loading..."):v.a.createElement("table",{className:"table"},v.a.createElement("thead",null,v.a.createElement("tr",null,v.a.createElement("th",null,"Player Name"),v.a.createElement("th",null,"Current Elo"))),v.a.createElement("tbody",null,c.map(function(e,t){return v.a.createElement("tr",{key:e.id,className:0==e.games_played?"inactive":""},v.a.createElement("th",null,v.a.createElement(ue.a,{to:"/players/"+e.id},(r=(n={player:e,idx:t,user:u,players:c}).player,a=n.idx,l=n.user,o=n.players,i="",0==a?i="😁 ":a==o.length-1&&(i="😞 "),l&&l.id==r.id&&(i+="☝️"),i+r.name))),v.a.createElement("td",null,Math.round(e.elo)));var n,r,a,l,o,i})))}),pe=Object(l.b)(function(e){return{canCreatePlayer:e.leagues.currentMembership&&"admin"==e.leagues.currentMembership.role}})(function(e){var t=e.canCreatePlayer;return v.a.createElement("div",{className:"players"},v.a.createElement("div",{className:"columns"},v.a.createElement("div",{className:"column is-two-thirds"},v.a.createElement(se,null)),t&&v.a.createElement("div",{className:"column is-one-third"},v.a.createElement("h2",null,"Add new player to the roster"),v.a.createElement(ce,null))))}),me=n(13),de=n.n(me),fe=n(25),he=n.n(fe),ye=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,l=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function be(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var ge=de()({loader:function(){return n.e(3).then(n.t.bind(null,61,7)).then(function(e){return he()(e)})},loading:function(){return v.a.createElement("div",null,"Loading...")}}),Ee=function(e){var t=e.playerId,n=e.players.find(function(e){return e.id==t});return n?n.name:null},we=function(e){var t=e.idToEntries,n=e.entries,l=e.players;for(var r in t)t[r].length<2?delete t[r]:t[r].reverse();for(var a=n.concat().sort(function(e,t){return e.created_at-t.created_at}),o=new Date(new Date(a[0].created_at.getTime()).setHours(23,59,59,999)),i=a[a.length-1].created_at,c=o,u=[];c<i;){u.push(c);var s=new Date(c.getTime());c=new Date(s.setDate(s.getDate()+1))}return Object.entries(t).map(function(e){var t,n=ye(e,2),r=n[0],a=n[1];return{x:[].concat(u,[i]),y:[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(u.map(function(e){return t=e,(n=a.find(function(e){return e.created_at<t}))&&n.score;var t,n})),[a[0].score]),type:"scatter",mode:"lines+markers",name:(t=r,Ee({playerId:t,players:l})),marker:{size:4},line:{width:1.5}}})},_e=function(e){var t=e.entry,n=e.prior,r=e.players,a=e.playerId,l=e.matches;if(null==t.match_id)return"Initial rating";var o=l.find(function(e){return e.id==t.match_id});if(null==o)return null;var i=a==o.player1_id,c=i?o.player2_id:o.player1_id,u=r.find(function(e){return e.id==c}).name,s=(o.player1_score-o.player2_score)*(i?1:-1),p=o.player1_score+o.player2_score==1?"":" "+[o.player1_score,o.player2_score].sort().reverse().join("-"),m=Math.round(10*(t.score-n.score))/10,d=0<m?"Rating increased "+m+" points":"Rating dropped "+(0-m)+" points";return 0<s?"Beat "+u+p+" ("+d+")":0==s?"Drew"+p+" against "+u+" ("+d+")":s<0?"Lost"+p+" to "+u+" ("+d+")":void 0},Oe=function(e){var t,n,r,a,l,o,i=e.entries,c=e.playerId,u=e.players,s=e.matches;return[{x:i.map(function(e,t){return t}),y:i.map(function(e){return e.score}),text:(t={entries:i,players:u,playerId:c,matches:s},n=t.entries,r=t.players,a=t.playerId,l=t.matches,o=null,n.map(function(e){var t=_e({entry:e,prior:o,players:r,playerId:a,matches:l});return o=e,t})),type:"scatter",line:{shape:"hv"},mode:"lines+markers"}]},Ce=function(e){var t,n,r,a=e.singleSeries,l=e.playerId,o=e.players;return{width:e.width,height:e.height,title:e.title||a&&(t={playerId:l,players:o},n=t.playerId,r=t.players,"Elo Score over time for "+Ee({playerId:n,players:r})),yaxis:{title:"Elo rating"},xaxis:{title:a?"Games played":"Time"}}},je=Object(l.b)(function(e){return{players:e.players,matches:e.matches.all}})(function(e){var t,n,r,a,l,o,i,c,u=e.matches,s=e.players,p=e.entries,m=be(e,["matches","players","entries"]);if(o=(l={entries:p,players:s,matches:u}).entries,i=l.players,c=l.matches,null==o||null==i||null==c)return v.a.createElement("div",null,"Loading...");if(n=(t={entries:p,players:s,matches:u}).entries,r=t.players,a=t.matches,0<n.length&&0<r.length&&0<a.length){var d=function(e){var t=e.matches,n=e.players,r=e.entries,a=e.playerId,l=be(e,["matches","players","entries","playerId"]),o={},i=!0,c=!1,u=void 0;try{for(var s,p=r[Symbol.iterator]();!(i=(s=p.next()).done);i=!0){var m=s.value;o[m.player_id]=o[m.player_id]||[],o[m.player_id].push(m)}}catch(e){c=!0,u=e}finally{try{!i&&p.return&&p.return()}finally{if(c)throw u}}var d=1==Object.keys(o).length,f=Ce(ve({singleSeries:d,playerId:a,players:n},l));return{data:d?Oe({entries:r,playerId:a,players:n,matches:t}):we({idToEntries:o,entries:r,players:n}),layout:f}}(ve({matches:u,players:s,entries:p},m));return v.a.createElement(ge,{data:d.data,layout:d.layout})}return v.a.createElement("div",null,"No data available yet")}),Ne=n(46),Se=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,l=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Ie=function(e){return Math.round(10*e)/10},ke={"-1":"losses",0:"draws",1:"wins"},Pe=function(t,l,e){if(!t||!l||!e)return[];var n={},r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value;if([u.player1_id,u.player2_id].includes(t)){var s=u.player1_id==t,p=u.player1_score>u.player2_score?1:u.player1_score<u.player2_score?-1:0,m=s?p:-p,d=s?u.player2_id:u.player1_id;n[d]||(n[d]={wins:0,losses:0,draws:0}),n[d][ke[m]]++}}}catch(e){a=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw o}}var f=l.find(function(e){return e.id==t}).elo,h=[],y=function(t,e){var n,r,a=l.find(function(e){return e.id==t});h.push({name:a.name,winPercent:(n=f,r=a.elo,1/(1+Math.pow(10,(r-n)/400))*100),results:e,id:t})},v=!0,b=!1,g=void 0;try{for(var E,w=Object.entries(n)[Symbol.iterator]();!(v=(E=w.next()).done);v=!0){var _=E.value,O=Se(_,2);y(O[0],O[1])}}catch(e){b=!0,g=e}finally{try{!v&&w.return&&w.return()}finally{if(b)throw g}}return h},xe=function(e){var t=e.playerId,n=e.players,r=e.matches,a=Pe(t,n,r);return v.a.createElement("div",{className:"head-to-head"},v.a.createElement("h2",{style:{fontWeight:"bold",fontSize:"20pt"}},"Head to Head results"),v.a.createElement("table",{className:"table"},v.a.createElement("thead",null,v.a.createElement("tr",null,v.a.createElement("th",null,"Opponent"),v.a.createElement("th",null,"Record"),v.a.createElement("th",null,"Projected Win %"))),v.a.createElement("tbody",null,a.map(function(e){return v.a.createElement("tr",{key:e.id},v.a.createElement("td",null,e.name),v.a.createElement("td",null,e.results.wins+"-"+e.results.losses+(e.results.draws?"-"+e.results.draws:"")),v.a.createElement("td",null,Ie(e.winPercent),"%"))}))))},Le=function(e){var c=e.playerId,t=e.entries,n=e.players,u=e.matches;if(!(c&&t&&n&&u))return null;var r=t[t.length-1],s=t[0],p=t[0],m=void 0,d=void 0,f=void 0,a=function(t){if(t.score>s.score&&(s=t),t.score<p.score&&(p=t),t.match_id){var e=u.find(function(e){return e.id==t.match_id}),n=e.player1_id==c,r=[e.player1_score,e.player2_score];n||r.reverse();var a=n?e.player2_id:e.player1_id,l=r[0]>r[1],o=r[1]>r[0],i=t.score-f.score;l?(!m||m.eloChange<i)&&(m={when:e.created_at,opponentId:a,eloChange:i,scores:r}):o&&(!d||d.eloChange>i)&&(d={when:e.created_at,opponentId:a,eloChange:i,scores:r})}f=t},l=!0,o=!1,i=void 0;try{for(var h,y=t[Symbol.iterator]();!(l=(h=y.next()).done);l=!0){a(h.value)}}catch(e){o=!0,i=e}finally{try{!l&&y.return&&y.return()}finally{if(o)throw i}}return m&&(m.opponentName=n.find(function(e){return e.id==m.opponentId}).name),d&&(d.opponentName=n.find(function(e){return e.id==d.opponentId}).name),v.a.createElement("div",{className:"elo-summary"},v.a.createElement("h2",{style:{fontWeight:"bold",fontSize:"20pt"}},"Elo Summary"),v.a.createElement("p",null,"Current score: ",v.a.createElement("b",null,r.score)),v.a.createElement("p",null,"Highest Elo achieved: ",v.a.createElement("b",null,Ie(s.score))," on ",Object(Ne.a)(s.created_at,new Date)),v.a.createElement("p",null,"Lowest Elo achieved: ",v.a.createElement("b",null,Ie(p.score))," on ",Object(Ne.a)(p.created_at,new Date)),m&&v.a.createElement("p",null,"Best win: Beat ",m.opponentName," ",m.scores.join("-")," on ",Object(Ne.a)(m.when,new Date)," and gained ",Ie(m.eloChange)," Elo."),d&&v.a.createElement("p",null,"Worst loss: Lost to ",d.opponentName," ",d.scores.join("-")," on ",Object(Ne.a)(d.when,new Date)," and dropped ",Ie(-d.eloChange)," Elo."))},Ae=Object(l.b)(function(e){return{matches:e.matches.all,players:e.players}})(function(e){var t=e.playerId,n=e.entries,r=e.matches,a=e.players;return v.a.createElement("div",{className:"player-match-summary columns"},v.a.createElement("div",{className:"column"},v.a.createElement(xe,{playerId:t,matches:r,players:a})),v.a.createElement("div",{className:"column"},v.a.createElement(Le,{playerId:t,matches:r,players:a,entries:n})))}),Te=Object(l.b)(function(e){return{eloEntries:e.eloEntries}})(function(e){var t,n,r=e.match,a=e.eloEntries,l=(t=r.params.playerId,null==(n=a)?null:n.filter(function(e){return e.player_id==t}));return v.a.createElement("div",{className:"player-detail"},v.a.createElement(je,{playerId:r.params.playerId,entries:l}),v.a.createElement(Ae,{playerId:parseInt(r.params.playerId),entries:l}))}),Me=Object(l.b)(function(e){return{eloEntries:e.eloEntries}})(function(e){var t=e.eloEntries;return v.a.createElement("div",{className:"dashboard columns"},v.a.createElement("div",{className:"column is-one-third"},v.a.createElement(se,null)),v.a.createElement("div",{className:"column is-two-thirds"},v.a.createElement(je,{entries:t,title:"Rating History of all players"})))}),De=(n(39),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Re=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var Ue=function(e){var t=e.onChange,n=e.opponentId,r=e.opponents;return v.a.createElement("div",{className:"select"},v.a.createElement("select",{onChange:t,value:n||"selectone"},v.a.createElement("option",{key:"selectone",value:"selectone",disabled:"disabled"},"Select opponent"),(r||[]).map(function(e){return v.a.createElement("option",{key:e.id,value:e.id},e.name)})))},He=function(e){var t=e.opponent,n=e.onChange,r=e.winner;return null==t?null:v.a.createElement("div",{className:"control"},v.a.createElement("label",{className:"radio"},"Winner: "),v.a.createElement("label",{className:"radio"},v.a.createElement("input",{type:"radio",name:"winner",value:"player1",checked:"player1"==r,onChange:n}),"Me"),v.a.createElement("label",{className:"radio"},v.a.createElement("input",{type:"radio",name:"winner",value:"player2",checked:"player2"==r,onChange:n}),t),v.a.createElement("label",{className:"radio"},v.a.createElement("input",{type:"radio",name:"winner",value:"draw",checked:"draw"==r,onChange:n}),"Draw"))},Ge=function(e){var t=e.score,n=e.onChange;return v.a.createElement(ae,{description:"Score (optional)"},v.a.createElement("input",{className:"input",name:"score",placeholder:"5-3",onChange:n,value:t}))},We=function(e){var t=e.comment,n=e.onChange;return v.a.createElement(ae,{description:"Comments (optional)"},v.a.createElement("input",{className:"input",name:"comment",placeholder:"A well fought match",onChange:n,value:t}))},qe=de()({loading:function(){return v.a.createElement("div",null,"Loading...")},loader:function(){return n.e(2).then(n.bind(null,62))}}),ze=function(e){var t=e.time,n=e.onChange;return v.a.createElement(ae,{description:"Match time"},v.a.createElement("div",null,v.a.createElement(qe,{selected:t?new Date(t):null,onChange:n,showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"yyyy-MM-dd h:mm aa",placeholderText:"Use default",timeCaption:"Time"})))},Be={opponentId:null,winner:null,comment:"",score:"",time:null},Je=function(e){function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));t.state=De({},Be);var n,r=e.currentlyEditing;return r&&(t.state.opponentId=r.player1_id==e.user.id?r.player2_id:r.player1_id,t.state.winner=r.player1_score==r.player2_score?"draw":r.player1_score>r.player2_score?"player1":"player2",t.state.comment=r.comment||"",t.state.score=(n=r).player1_score+n.player2_score!=1?[n.player1_score,n.player2_score].sort().reverse().join("-"):"",t.state.time=r.created_at),t.opponentSelected=t.opponentSelected.bind(t),t.setComment=t.setComment.bind(t),t.setScore=t.setScore.bind(t),t.setTime=t.setTime.bind(t),t.winnerSelected=t.winnerSelected.bind(t),t.handleSubmit=t.handleSubmit.bind(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,r["Component"]),Re(a,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.getScores(),n={player1_id:this.props.user.id,player2_id:this.state.opponentId,player1_score:t[0],player2_score:t[1],comment:""==this.state.comment?null:this.state.comment,created_at:this.state.time};this.props.currentlyEditing?(this.props.updateMatch(De({},n,{id:this.props.currentlyEditing.id})),this.props.cancelEditing()):this.props.createMatch(n),this.setState({winner:null,comment:"",score:""})}},{key:"opponentSelected",value:function(e){this.setState({opponentId:parseInt(e.target.value)})}},{key:"setComment",value:function(e){this.setState({comment:e.target.value})}},{key:"setTime",value:function(e){this.setState({time:e})}},{key:"getScores",value:function(){var e=this.state,n=e.winner,t=e.score;if(null==n)return null;if(""==t)switch(n){case"player1":return[1,0];case"player2":return[0,1];case"draw":return[.5,.5]}var r=t.match(/(\d+)-(\d+)/);if(null==r)return null;var a=r.slice(1).map(function(e){return parseInt(e)});return isNaN(a[0]||isNaN(a[1]))?null:"draw"==n!=(a[0]==a[1])?null:a.sort(function(e,t){return"player1"==n?t-e:e-t})}},{key:"setScore",value:function(e){this.setState({score:e.target.value})}},{key:"canSubmit",value:function(){return null!=this.state.opponentId&&null!=this.getScores()}},{key:"winnerSelected",value:function(e){this.setState({winner:e.target.value})}},{key:"render",value:function(){var e=this.state,t=e.opponentId,n=e.winner,r=e.score,a=e.comment,l=e.time,o=this.props,i=o.players,c=o.user,u=o.currentlyEditing,s=o.cancelEditing,p=t&&i.find(function(e){return e.id==t});return v.a.createElement("form",{onSubmit:this.handleSubmit},v.a.createElement(Ue,{onChange:this.opponentSelected,opponentId:t,opponents:(i||[]).filter(function(e){return e.id!=c.id})}),v.a.createElement(He,{winner:n,onChange:this.winnerSelected,opponent:p&&p.name}),v.a.createElement(Ge,{score:r,onChange:this.setScore}),v.a.createElement(We,{onChange:this.setComment,comment:a}),v.a.createElement(ze,{onChange:this.setTime,time:l}),v.a.createElement("button",{type:"submit",className:"button is-primary",disabled:!this.canSubmit()},"SAVE"),u&&v.a.createElement("button",{type:"button",className:"button is-warning",onClick:s},"Cancel editing"))}}]),a}(),Ve=Object(l.b)(function(e){return{players:e.players,user:e.userContext.currentUser}},function(t){return{createMatch:function(e){return t(T(e))},updateMatch:function(e){return t(M(e))},cancelEditing:function(){return t(A(null))}}})(Je),Fe=n(27),Ye=(n(40),function(t,n,r,e,a){var l=[{Header:"Time",accessor:"created_at",Cell:function(e){return v.a.createElement("span",{title:e.value,className:"relative-date"},Object(Ne.a)(e.value,new Date))},minWidth:150},{id:"outcome",Header:"Outcome",accessor:function(e){return function(){return function(t,e,n){if(!e||0==e.length)return"";var r=e.find(function(e){return e.id==t.player1_id}).name,a=e.find(function(e){return e.id==t.player2_id}).name;if(t.player1_score==t.player2_score)return r+" drew against "+a;var l=t.player1_score>t.player2_score,o=l?r+" def. "+a:a+" def. "+r;return n&&[t.player1_id,t.player2_id].includes(n.id)&&(o+=l==(n.id==t.player1_id)?" 🎉":" 😢"),o}(e,t,n)}},Cell:function(e){return e.value()},minWidth:200},{id:"score",Header:"Score",accessor:function(t){return function(){return(e=t).player1_score+e.player2_score!=1?[e.player1_score,e.player2_score].sort().reverse().join("-"):"";var e}},Cell:function(e){return e.value()},maxWidth:75},{id:"elochange",Header:"Elo Change",accessor:function(e){return function(){return function(e,t){if(!t)return null;var n=void 0,r=void 0,a=!0,l=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(a=(i=c.next()).done);a=!0){var u=i.value;if(u.match_id==e.id){if(!n)return null;r=u.score-n.score;break}n=u}}catch(e){l=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(l)throw o}}return"±"+Math.round(10*Math.abs(r))/10}(e,r)}},Cell:function(e){return e.value()}},{Header:"Comment",accessor:"comment"}];return e&&"admin"==e.role&&l.push({Header:"Edit",id:"edit",accessor:function(e){return[e.player1_id,e.player2_id].includes(n.id)&&e.id},maxWidth:40,Cell:function(e){return e.value&&v.a.createElement("a",{className:"edit-match","data-matchid":e.value,onClick:a},"⚙️")}}),l}),Ke=Object(l.b)(function(e){return{matches:e.matches.all,players:e.players,user:e.userContext.currentUser,eloEntries:e.eloEntries,currentMembership:e.leagues.currentMembership}},function(t){return{setEditingMatch:function(e){return t(A(e))}}})(function(e){var n=e.matches,t=e.players,r=e.user,a=e.eloEntries,l=e.currentMembership,o=e.setEditingMatch;return null!=n&&v.a.createElement(Fe.a,{data:n,columns:Ye(t,r,a,l,function(t){return o(n.find(function(e){return e.id==t.target.dataset.matchid}))}),minRows:"2"})}),Qe=Object(l.b)(function(e){return{canCreateMatch:e.leagues.currentMembership&&"admin"==e.leagues.currentMembership.role,currentlyEditing:e.matches.currentlyEditing}})(function(e){var t=e.canCreateMatch,n=e.currentlyEditing;return v.a.createElement("div",{className:"matches"},v.a.createElement("div",{className:"columns"},v.a.createElement("div",{className:"column is-two-thirds"},v.a.createElement(Ke,null)),t&&v.a.createElement("div",{className:"column is-one-third"},v.a.createElement("h2",null,n?"Edit match":"Record a match"),v.a.createElement(Ve,{currentlyEditing:n,key:n?n.id:"fresh"}))))}),Xe=n(44),Ze=Object(Xe.a)(function(e){var t=e.location,n=e.history,r=e.league,a=e.current,l=e.setLeague;return v.a.createElement("li",{key:r.id,className:"league "+(r.id==a?"current":"")},v.a.createElement("span",{onClick:function(){return l(r.id,a,t,n)}},r.name))}),$e=Object(l.b)(function(e){return{leagues:e.leagues.all,leagueId:e.leagues.current}},function(l){return{setLeague:function(e,t,n,r){if(e!=t){l(R(e));var a=n.state;a&&a.from&&r.push(a.from)}}}})(function(e){var t=e.leagues,n=e.leagueId,r=e.setLeague;return v.a.createElement("ul",{className:"league-list"},(t||[]).map(function(e){return v.a.createElement(Ze,{key:e.id,league:e,current:n,setLeague:r})}))}),et=function(){return v.a.createElement("div",{className:"league-selector"},v.a.createElement("h2",{className:"subtitle"},"Select a league"),v.a.createElement("br",null),v.a.createElement($e,null))},tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nt=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var rt=v.a.memo(function(e){var t=e.onChange,n=e.sport,r=e.sports;return v.a.createElement(ae,null,v.a.createElement("select",{required:"required",name:"sport_id",value:n,onChange:t},v.a.createElement("option",{value:"",disabled:"disabled"},"Select a sport"),(r||[]).map(function(e){return v.a.createElement("option",{key:e.id,value:e.id},e.name)})))}),at={members_only:!1,name:"",description:"",sport_id:"",domain:""},lt=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=at,e.handleChange=e.handleChange.bind(e),e.handleSubmit=e.handleSubmit.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["PureComponent"]),nt(t,[{key:"componentDidMount",value:function(){this.props.sports||this.props.loadSports()}},{key:"handleChange",value:function(e){var t,n,r,a="checkbox"===e.target.type?e.target.checked:e.target.value;"sport_id"==e.target.name&&(a=parseInt(a)),this.setState((t={},n=e.target.name,r=a,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=tt({},this.state,{description:this.state.description||null,domain:this.state.domain||null});this.props.createLeague(t),this.setState(at)}},{key:"isDisabled",value:function(){return!(this.state.name&&this.state.sport_id)}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.description,r=e.domain,a=e.members_only,l=e.sport_id;return v.a.createElement("form",{onSubmit:this.handleSubmit},v.a.createElement(ae,{description:"Name"},v.a.createElement("input",{type:"text",className:"input is-primary",name:"name",required:"required",placeholder:"Enter the league name",value:t,onChange:this.handleChange})),v.a.createElement(ae,{description:"Description (optional)"},v.a.createElement("textarea",{className:"textarea",name:"description",placeholder:"Description of this league",value:n,onChange:this.handleChange})),v.a.createElement(ae,{description:"Domain restriction (optional)"},v.a.createElement("input",{type:"text",className:"input is-primary",name:"domain",placeholder:"Members' emails must be @ this domain",value:r,onChange:this.handleChange})),v.a.createElement(ae,{description:"Members Only"},v.a.createElement("input",{type:"checkbox",name:"members_only",checked:a,onChange:this.handleChange})),v.a.createElement(rt,{sport:l,onChange:this.handleChange,sports:this.props.sports}),v.a.createElement("button",{type:"submit",disabled:this.isDisabled(),className:"button is-primary"},"Create League"))}}]),t}(),ot=Object(l.b)(function(e){return{sports:e.sports}},function(t){return{loadSports:function(){return t(G())},createLeague:function(e){return t(H(e))}}})(lt),it=Object(l.b)(function(e){return{canCreateLeague:!!e.userContext.currentUser}})(function(e){var t=e.canCreateLeague,n=e.location,r=e.history;return v.a.createElement("div",{className:"leagues"},v.a.createElement("div",{className:"columns"},v.a.createElement("div",{className:"column is-two-thirds"},v.a.createElement(et,{location:n,history:r})),t&&v.a.createElement("div",{className:"column is-one-third"},v.a.createElement("h2",null,"Start a new league"),v.a.createElement(ot,null))))}),ct=Object(l.b)(function(e){return{leagues:e.leagues,user:e.userContext.currentUser}},function(t){return{joinLeague:function(e){return t((n=e,function(t,e){return N("/api/league_memberships",{player_id:e().userContext.currentUser.id,league_id:n},e,t).then(function(e){t(D(e)),t(k()),t(I())})}));var n}}})(function(e){var t=e.joinLeague,n=e.leagues,r=e.user;return null!=n.all&&n.current&&r&&!n.currentMembership?v.a.createElement("div",{className:"join-league",onClick:function(){return t(n.current)}},"Join this league"):null}),ut=Object(l.b)(function(e){return{isLoading:0<e.loading.numPending}})(function(e){return e.isLoading?v.a.createElement("div",{className:"loader"},"Loading..."):null}),st=Object(l.b)(function(e){return{isLoading:0<e.loading.numPending}})(function(e){var t=e.isLoading,n=e.children;return v.a.createElement(r.Fragment,null,v.a.createElement("div",{className:"container "+(t?"fade-out":"fade-in")},n),v.a.createElement(ut,null))}),pt=n(45),mt=Object(l.b)(function(e){return{all:e.leagues.all,current:e.leagues.current}})(function(e){var t=e.all,n=e.current;if(null!=t){var r=t.find(function(e){return e.id==n});if(null!=r)return v.a.createElement("span",null,"Current League: ",r.name)}return null}),dt=Object(Xe.a)(function(e){var t=e.location;return v.a.createElement(pt.a,{to:{pathname:"/leagues",state:{from:t.pathname}},activeClassName:"hidden"},"Change League")}),ft=v.a.memo(function(){return v.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},v.a.createElement("a",{className:"navbar-link"},v.a.createElement(mt,null)),v.a.createElement("div",{className:"navbar-dropdown"},v.a.createElement(dt,null)))}),ht=n(17),yt=function(e){console.warn(e.error)},vt=Object(l.b)(function(e){return{user:e.userContext.currentUser}},function(t){return{googleAuth:function(e){return t((n=e.tokenId,function(t,e){return N("/api/users",{token:n},e,t).then(function(e){e.player&&null==e.error?t(W(e.player)):console.error("Error signing in: "+e.error)})}));var n},signOut:function(){return t(function(e){e({type:E}),fetch("/api/sessions/current",{method:"DELETE"})})}}})(function(e){var t=e.user,n=e.googleAuth,r=e.signOut;return t?v.a.createElement(ht.GoogleLogout,{buttonText:"Logout",onLogoutSuccess:r}):v.a.createElement(ht.GoogleLogin,{clientId:"985074612801-rir5ouc3r4e7kaq6u25j1c12bko24rqq.apps.googleusercontent.com",buttonText:"Login with Google",onSuccess:n,onFailure:yt})}),bt=Object(l.b)(function(e){return{user:e.userContext.currentUser}})(function(e){var t=e.user;return t?t.name:"Not logged in."}),gt=function(){return v.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},v.a.createElement("a",{className:"navbar-link"},v.a.createElement(bt,null)),v.a.createElement("div",{className:"navbar-dropdown"},v.a.createElement(vt,null)))},Et=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var wt=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={burgerized:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.a.Component),Et(t,[{key:"toggleBurger",value:function(){this.setState({burgerized:!this.state.burgerized})}},{key:"render",value:function(){var e=this.state.burgerized;return v.a.createElement("nav",{className:"navbar",role:"navigation","aria-label":"main navigation"},v.a.createElement("div",{className:"navbar-brand"},v.a.createElement("a",{className:"navbar-item",href:"/"},v.a.createElement("img",{src:"/logo.png",width:"80",height:"28"})),v.a.createElement("a",{role:"button",className:"navbar-burger burger"+(e?" is-active":""),"aria-label":"menu","aria-expanded":"false",onClick:this.toggleBurger.bind(this)},v.a.createElement("span",{"aria-hidden":"true"}),v.a.createElement("span",{"aria-hidden":"true"}),v.a.createElement("span",{"aria-hidden":"true"}))),v.a.createElement("div",{className:"navbar-menu"+(e?" is-active":"")},v.a.createElement("div",{className:"navbar-start"},v.a.createElement(pt.a,{exact:!0,to:"/",className:"navbar-item",activeClassName:"is-active"},"Overview"),v.a.createElement(pt.a,{to:"/players",className:"navbar-item",activeClassName:"is-active"},"Players"),v.a.createElement(pt.a,{to:"/matches",className:"navbar-item",activeClassName:"is-active"},"Matches")),v.a.createElement("div",{className:"navbar-end"},v.a.createElement(gt,null),v.a.createElement(ft,null))))}}]),t}(),_t=(n(41),n(42),function(){return v.a.createElement(st,null,v.a.createElement(ct,null),v.a.createElement(wt,null),v.a.createElement(Z.a,null,v.a.createElement(re,{exact:!0,path:"/players",component:pe}),v.a.createElement(re,{path:"/players/:playerId",component:Te}),v.a.createElement(re,{path:"/matches",component:Qe}),v.a.createElement(re,{exact:!0,path:"/",component:Me}),v.a.createElement($.a,{path:"/leagues",component:it})))}),Ot=function(){return v.a.createElement(ee.a,null,v.a.createElement(_t,null))};Object(a.render)(v.a.createElement(l.a,{store:X},v.a.createElement(Ot,null)),document.getElementById("app"))}});