!function(u){function e(e){for(var t,n,r=e[0],a=e[1],l=e[2],o=e[3]||[],i=0,c=[];i<r.length;i++)n=r[i],p[n]&&c.push(p[n][0]),p[n]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(u[t]=a[t]);for(h&&h(e),o.forEach(function(e){if(void 0===p[e]){p[e]=null;var t=document.createElement("link");f.nc&&t.setAttribute("nonce",f.nc),t.rel="prefetch",t.as="script",t.href=d(e),document.head.appendChild(t)}});c.length;)c.shift()();return m.push.apply(m,l||[]),s()}function s(){for(var e,t=0;t<m.length;t++){for(var n=m[t],r=!0,a=1;a<n.length;a++){var l=n[a];0!==p[l]&&(r=!1)}r&&(m.splice(t--,1),e=f(f.s=n[0]))}return e}var n={},p={0:0},m=[];function d(e){return f.p+""+({}[e]||e)+"-"+{2:"d7029d2c4434c73f87b5"}[e]+".js"}function f(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return u[e].call(t.exports,t,t.exports,f),t.l=!0,t.exports}f.e=function(l){var e=[],n=p[l];if(0!==n)if(n)e.push(n[2]);else{var t=new Promise(function(e,t){n=p[l]=[e,t]});e.push(n[2]=t);var r,o=document.createElement("script");o.charset="utf-8",o.timeout=120,f.nc&&o.setAttribute("nonce",f.nc),o.src=d(l),r=function(e){o.onerror=o.onload=null,clearTimeout(i);var t=p[l];if(0!==t){if(t){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,a=new Error("Loading chunk "+l+" failed.\n("+n+": "+r+")");a.type=n,a.request=r,t[1](a)}p[l]=void 0}};var i=setTimeout(function(){r({type:"timeout",target:o})},12e4);o.onerror=o.onload=r,document.head.appendChild(o)}return Promise.all(e)},f.m=u,f.c=n,f.d=function(e,t,n){f.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},f.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.t=function(t,e){if(1&e&&(t=f(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(f.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)f.d(n,r,function(e){return t[e]}.bind(null,r));return n},f.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(t,"a",t),t},f.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f.p="",f.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],r=t.push.bind(t);t.push=e,t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var h=r;e([[],{},0,[2]]),m.push([41,1]),s()}({40:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var r=n(0),f=n.n(r),a=n(20),l=n(2),o=n(22),i=n(8),c="ADD_PLAYER",u="ADD_MATCH",s="ADD_LEAGUE",p="RECEIVE_PLAYERS",m="RECEIVE_MATCHES",d="RECEIVE_ELO_ENTRIES",h="RECEIVE_SPORTS",y="SET_LEAGUE",v="RECEIVE_LEAGUES",b="SIGN_IN",g="SIGN_OUT",E="JOINED_LEAGUE",w="LOADING_BEGIN",O="LOADING_COMPLETE",_="LOADING_FAIL",C=function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{headers:{}},a=arguments[2],l=arguments[3];return new Promise(function(t,n){l({type:w,payload:e}),a&&(r.headers["League-Id"]=a().leagues.current),fetch(e,r).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(e){!1!==n(e)&&l({type:_,error:e})}).then(function(){return l({type:O,payload:e})})})},N=function(e,t,n,r){return C(e,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)},n,r)},j=function(n,r,a){return function(){return function(e,t){return C(n,void 0,t,e).then(r.bind(null,e),a||function(e){return console.error(e)})}}},S=j("/api/elo_entries",function(e,t){return e({type:d,payload:t})}),I=j("/api/players",function(e,t){return e({type:p,payload:t})}),k=function(n){return function(t,e){return N("/api/players",n,e,t).then(function(e){return t({type:c,payload:e})},function(e){return console.error(e)})}},P=j("/api/matches",function(e,t){return e(x(t))}),x=function(e){return{type:m,payload:e}},L=function(n){return function(t,e){return N("/api/matches",n,e,t).then(function(e){t({type:u,payload:e}),t(I()),t(S())},function(e){return console.error(e)})}},A=function(e){return{type:E,payload:e}},T=function(t){return function(e){window.localStorage.setItem("leagueId",t),e({type:y,payload:t}),e(I()),e(P()),e(S())}},D=j("/api/leagues",function(e,t){return e({type:v,payload:t})}),M=function(n){return function(t,e){return N("/api/leagues",n,e,t).then(function(e){t({type:s,payload:e}),t(A({league_id:e.id,role:"admin"}))},function(e){return console.error(e)})}},R=j("/api/sports",function(e,t){return e({type:h,payload:t})}),U=function(e){return{type:b,payload:e}},G=j("/api/users/me",function(e,t){return e(U(t))},function(e){return!1});var H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function q(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B=Object(i.c)({players:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case c:return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e),[t.payload]).sort(function(e,t){return t.elo-e.elo});case p:return t.payload;case y:return null;default:return e}},matches:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case m:return t.payload;case u:return[t.payload].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e));case y:return null;default:return e}},userContext:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case b:return V({},e,{currentUser:t.payload});case g:return V({},e,{currentUser:null});default:return e}},eloEntries:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case d:return t.payload.map(function(e){return e.created_at=new Date(e.created_at),e});case y:return null;default:return e}},leagues:function(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],a=n;switch(r.type){case v:a=H({},n,{all:r.payload});break;case s:a=H({},n,{all:[].concat(q(n.all),[r.payload])});break;case y:a=H({},n,{current:r.payload});break;case b:a=H({},n,{memberships:r.payload.league_memberships});break;case g:a=H({},n,{memberships:null});break;case E:a=H({},n,{memberships:[].concat(q(n.memberships),[r.payload])})}return a.currentMembership=(t=a.current,e=a.memberships,t&&e&&e.find(function(e){return e.league_id==t})),a},loading:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{numPending:0,error:null},t=arguments[1];switch(t.type){case w:return z({},e,{numPending:e.numPending+1});case _:return z({},e,{error:t.payload});case O:return z({},e,{numPending:e.numPending-1});default:return e}},sports:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case h:return t.payload;default:return e}}}),J=Object(i.d)(B,Object(i.a)(o.a)),W=window.localStorage.getItem("leagueId");J.dispatch(D()),J.dispatch(G()),W&&J.dispatch(T(Number(W)));var F=J,Y=n(48),K=n(23),Q=n(47),X=n(46),Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var $=function(e){var t=e.component,n=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["component"]);return f.a.createElement(K.a,Z({},n,{component:Object(l.b)(function(e){return{leagueId:e.leagues.current}})(function(e){return null!=e.leagueId?f.a.createElement(t,e):f.a.createElement(X.a,{to:{pathname:"/leagues",state:{from:e.location}}})})}))},ee=function(e){var t=e.children,n=e.description;return f.a.createElement("div",{className:"field"},f.a.createElement("label",{className:"label"},n,t))},te=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var ne={name:"",elo:1500},re=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=ne,e.handleChange=e.handleChange.bind(e),e.handleSubmit=e.handleSubmit.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),te(t,[{key:"handleChange",value:function(e){var t,n,r;this.setState((t={},n=e.target.name,r=e.target.value,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.createPlayer({name:this.state.name,elo:parseInt(this.state.elo)}),this.setState(ne)}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.elo;return f.a.createElement("form",{onSubmit:this.handleSubmit},f.a.createElement(ee,{description:"Name"},f.a.createElement("input",{type:"text",className:"input is-primary",name:"name",placeholder:"Enter the player's name",value:t,onChange:this.handleChange})),f.a.createElement(ee,{description:"Initial Elo"},f.a.createElement("input",{type:"number",className:"input is-primary",name:"elo",placeholder:"Enter the player's starting Elo score",value:n,disabled:"disabled",onChange:this.handleChange})),f.a.createElement("button",{type:"submit",className:"button is-primary"},"Create Player"))}}]),t}(),ae=Object(l.b)(null,function(t){return{createPlayer:function(e){return t(k(e))}}})(re),le=n(15),oe=Object(l.b)(function(e){return{players:e.players,user:e.userContext.currentUser}})(function(e){var c=e.players,u=e.user;return null==c?f.a.createElement("div",null,"Loading..."):f.a.createElement("table",{className:"table"},f.a.createElement("thead",null,f.a.createElement("tr",null,f.a.createElement("th",null,"Player Name"),f.a.createElement("th",null,"Current Elo"))),f.a.createElement("tbody",null,c.map(function(e,t){return f.a.createElement("tr",{key:e.id,className:0==e.games_played?"inactive":""},f.a.createElement("th",null,f.a.createElement(le.a,{to:"/players/"+e.id},(r=(n={player:e,idx:t,user:u,players:c}).player,a=n.idx,l=n.user,o=n.players,i="",0==a?i="😁 ":a==o.length-1&&(i="😞 "),l&&l.id==r.id&&(i+="☝️"),i+r.name))),f.a.createElement("td",null,Math.round(e.elo)));var n,r,a,l,o,i})))}),ie=Object(l.b)(function(e){return{canCreatePlayer:e.leagues.currentMembership&&"admin"==e.leagues.currentMembership.role}})(function(e){var t=e.canCreatePlayer;return f.a.createElement("div",{className:"players"},f.a.createElement("div",{className:"columns"},f.a.createElement("div",{className:"column is-two-thirds"},f.a.createElement(oe,null)),t&&f.a.createElement("div",{className:"column is-one-third"},f.a.createElement("h2",null,"Add new player to the roster"),f.a.createElement(ae,null))))}),ce=n(24),ue=n.n(ce),se=n(25),pe=n.n(se),me=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,l=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function fe(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var he=ue()({loader:function(){return n.e(2).then(n.t.bind(null,49,7)).then(function(e){return pe()(e)})},loading:function(){return f.a.createElement("div",null,"Loading...")}}),ye=function(e){var t=e.playerId,n=e.players.find(function(e){return e.id==t});return n?n.name:null},ve=function(e){var t=e.idToEntries,n=e.entries,l=e.players;for(var r in t)t[r].length<2?delete t[r]:t[r].reverse();for(var a=n.concat().sort(function(e,t){return e.created_at-t.created_at}),o=new Date(new Date(a[0].created_at.getTime()).setHours(23,59,59,999)),i=a[a.length-1].created_at,c=o,u=[];c<i;){u.push(c);var s=new Date(c.getTime());c=new Date(s.setDate(s.getDate()+1))}return Object.entries(t).map(function(e){var t,n=me(e,2),r=n[0],a=n[1];return{x:[].concat(u,[i]),y:[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(u.map(function(e){return t=e,(n=a.find(function(e){return e.created_at<t}))&&n.score;var t,n})),[a[0].score]),type:"scatter",mode:"lines+markers",name:(t=r,ye({playerId:t,players:l})),marker:{size:4},line:{width:1.5}}})},be=function(e){var t=e.entry,n=e.prior,r=e.players,a=e.playerId,l=e.matches;if(null==t.match_id)return"Initial rating";var o=l.find(function(e){return e.id==t.match_id});if(null==o)return null;var i=a==o.player1_id,c=i?o.player2_id:o.player1_id,u=r.find(function(e){return e.id==c}).name,s=(o.player1_score-o.player2_score)*(i?1:-1),p=o.player1_score+o.player2_score==1?"":" "+[o.player1_score,o.player2_score].sort().reverse().join("-"),m=Math.round(10*(t.score-n.score))/10,d=0<m?"Rating increased "+m+" points":"Rating dropped "+(0-m)+" points";return 0<s?"Beat "+u+p+" ("+d+")":0==s?"Drew"+p+" against "+u+" ("+d+")":s<0?"Lost"+p+" to "+u+" ("+d+")":void 0},ge=function(e){var t,n,r,a,l,o,i=e.entries,c=e.playerId,u=e.players,s=e.matches;return[{x:i.map(function(e,t){return t}),y:i.map(function(e){return e.score}),text:(t={entries:i,players:u,playerId:c,matches:s},n=t.entries,r=t.players,a=t.playerId,l=t.matches,o=null,n.map(function(e){var t=be({entry:e,prior:o,players:r,playerId:a,matches:l});return o=e,t})),type:"scatter",line:{shape:"hv"},mode:"lines+markers"}]},Ee=function(e){var t,n,r,a=e.singleSeries,l=e.playerId,o=e.players;return{width:e.width,height:e.height,title:e.title||a&&(t={playerId:l,players:o},n=t.playerId,r=t.players,"Elo Score over time for "+ye({playerId:n,players:r})),yaxis:{title:"Elo rating"},xaxis:{title:a?"Games played":"Time"}}},we=Object(l.b)(function(e){return{players:e.players,matches:e.matches}})(function(e){var t,n,r,a,l,o,i,c,u=e.matches,s=e.players,p=e.entries,m=fe(e,["matches","players","entries"]);if(o=(l={entries:p,players:s,matches:u}).entries,i=l.players,c=l.matches,null==o||null==i||null==c)return f.a.createElement("div",null,"Loading...");if(n=(t={entries:p,players:s,matches:u}).entries,r=t.players,a=t.matches,0<n.length&&0<r.length&&0<a.length){var d=function(e){var t=e.matches,n=e.players,r=e.entries,a=e.playerId,l=fe(e,["matches","players","entries","playerId"]),o={},i=!0,c=!1,u=void 0;try{for(var s,p=r[Symbol.iterator]();!(i=(s=p.next()).done);i=!0){var m=s.value;o[m.player_id]=o[m.player_id]||[],o[m.player_id].push(m)}}catch(e){c=!0,u=e}finally{try{!i&&p.return&&p.return()}finally{if(c)throw u}}var d=1==Object.keys(o).length,f=Ee(de({singleSeries:d,playerId:a,players:n},l));return{data:d?ge({entries:r,playerId:a,players:n,matches:t}):ve({idToEntries:o,entries:r,players:n}),layout:f}}(de({matches:u,players:s,entries:p},m));return f.a.createElement(he,{data:d.data,layout:d.layout})}return f.a.createElement("div",null,"No data available yet")}),Oe=Object(l.b)(function(e){return{eloEntries:e.eloEntries}})(function(e){var t,n,r=e.match,a=e.eloEntries;return f.a.createElement(we,{playerId:r.params.playerId,entries:(t=r.params.playerId,n=a,null==n?null:n.filter(function(e){return e.player_id==t}))})}),_e=Object(l.b)(function(e){return{eloEntries:e.eloEntries}})(function(e){var t=e.eloEntries;return f.a.createElement("div",{className:"dashboard columns"},f.a.createElement("div",{className:"column is-one-third"},f.a.createElement(oe,null)),f.a.createElement("div",{className:"column is-two-thirds"},f.a.createElement(we,{entries:t,title:"Rating History of all players"})))}),Ce=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var Ne=function(e){var t=e.onChange,n=e.opponentId,r=e.opponents;return f.a.createElement("div",{className:"select"},f.a.createElement("select",{onChange:t,value:n||"selectone"},f.a.createElement("option",{key:"selectone",value:"selectone",disabled:"disabled"},"Select opponent"),(r||[]).map(function(e){return f.a.createElement("option",{key:e.id,value:e.id},e.name)})))},je=function(e){var t=e.opponent,n=e.onChange,r=e.winner;return null==t?null:f.a.createElement("div",{className:"control"},f.a.createElement("label",{className:"radio"},"Winner: "),f.a.createElement("label",{className:"radio"},f.a.createElement("input",{type:"radio",name:"winner",value:"player1",checked:"player1"==r,onChange:n}),"Me"),f.a.createElement("label",{className:"radio"},f.a.createElement("input",{type:"radio",name:"winner",value:"player2",checked:"player2"==r,onChange:n}),t),f.a.createElement("label",{className:"radio"},f.a.createElement("input",{type:"radio",name:"winner",value:"draw",checked:"draw"==r,onChange:n}),"Draw"))},Se=function(e){var t=e.score,n=e.onChange;return f.a.createElement("div",{className:"field"},f.a.createElement("label",{className:"label"},"Score (optional)"),f.a.createElement("div",{className:"control"},f.a.createElement("input",{className:"input",name:"score",placeholder:"5-3",onChange:n,value:t})))},Ie=function(e){var t=e.comment,n=e.onChange;return f.a.createElement("div",{className:"field"},f.a.createElement("label",{className:"label"},"Comments (optional)"),f.a.createElement("div",{className:"control"},f.a.createElement("input",{className:"input",name:"comment",placeholder:"A well fought match",onChange:n,value:t})))},ke={opponentId:null,winner:null,comment:"",score:""},Pe=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=ke,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),Ce(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.getScores();this.props.createMatch({player1_id:this.props.user.id,player2_id:this.state.opponentId,player1_score:t[0],player2_score:t[1],comment:""==this.state.comment?null:this.state.comment}),this.setState({winner:null,comment:"",score:""})}},{key:"opponentSelected",value:function(e){this.setState({opponentId:parseInt(e.target.value)})}},{key:"setComment",value:function(e){this.setState({comment:e.target.value})}},{key:"getScores",value:function(){var e=this.state,n=e.winner,t=e.score;if(null==n)return null;if(""==t)switch(n){case"player1":return[1,0];case"player2":return[0,1];case"draw":return[.5,.5]}var r=t.match(/(\d+)-(\d+)/);if(null==r)return null;var a=r.slice(1).map(function(e){return parseInt(e)});return isNaN(a[0]||isNaN(a[1]))?null:"draw"==n!=(a[0]==a[1])?null:a.sort(function(e,t){return"player1"==n?t-e:e-t})}},{key:"setScore",value:function(e){this.setState({score:e.target.value})}},{key:"canSubmit",value:function(){return null!=this.state.opponentId&&null!=this.getScores()}},{key:"winnerSelected",value:function(e){this.setState({winner:e.target.value})}},{key:"render",value:function(){var e=this.state,t=e.opponentId,n=e.winner,r=e.score,a=e.comment,l=this.props,o=l.players,i=l.user,c=t&&o.find(function(e){return e.id==t});return f.a.createElement("form",{onSubmit:this.handleSubmit.bind(this)},f.a.createElement(Ne,{onChange:this.opponentSelected.bind(this),opponentId:t,opponents:(o||[]).filter(function(e){return e.id!=i.id})}),f.a.createElement(je,{winner:n,onChange:this.winnerSelected.bind(this),opponent:c&&c.name}),f.a.createElement(Se,{score:r,onChange:this.setScore.bind(this)}),f.a.createElement(Ie,{onChange:this.setComment.bind(this),comment:a}),f.a.createElement("button",{type:"submit",className:"button is-primary",disabled:!this.canSubmit()},"SAVE"))}}]),t}(),xe=Object(l.b)(function(e){return{players:e.players,user:e.userContext.currentUser}},function(t){return{createMatch:function(e){return t(L(e))}}})(Pe),Le=n(27),Ae=(n(38),n(45)),Te=function(t,n,r){return[{Header:"Time",accessor:"created_at",Cell:function(e){return f.a.createElement("span",{title:e.value,className:"relative-date"},Object(Ae.a)(e.value,new Date))},minWidth:150},{id:"outcome",Header:"Outcome",accessor:function(e){return function(){return function(t,e,n){if(!e||0==e.length)return"";var r=e.find(function(e){return e.id==t.player1_id}).name,a=e.find(function(e){return e.id==t.player2_id}).name;if(t.player1_score==t.player2_score)return r+" drew against "+a;var l=t.player1_score>t.player2_score,o=l?r+" def. "+a:a+" def. "+r;return n&&[t.player1_id,t.player2_id].includes(n.id)&&(o+=l==(n.id==t.player1_id)?" 🎉":" 😢"),o}(e,t,n)}},Cell:function(e){return e.value()},minWidth:200},{id:"score",Header:"Score",accessor:function(t){return function(){return(e=t).player1_score+e.player2_score!=1?[e.player1_score,e.player2_score].sort().reverse().join("-"):"";var e}},Cell:function(e){return e.value()},maxWidth:75},{id:"elochange",Header:"Elo Change",accessor:function(e){return function(){return function(e,t){if(!t)return null;var n=void 0,r=void 0,a=!0,l=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(a=(i=c.next()).done);a=!0){var u=i.value;if(u.match_id==e.id){if(!n)return null;r=u.score-n.score;break}n=u}}catch(e){l=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(l)throw o}}return"±"+Math.round(10*Math.abs(r))/10}(e,r)}},Cell:function(e){return e.value()}},{Header:"Comment",accessor:"comment"}]},De=Object(l.b)(function(e){return{matches:e.matches,players:e.players,user:e.userContext.currentUser,eloEntries:e.eloEntries}})(function(e){var t=e.matches,n=e.players,r=e.user,a=e.eloEntries;return null!=t&&f.a.createElement(Le.a,{data:t,columns:Te(n,r,a),minRows:"2"})}),Me=Object(l.b)(function(e){return{canCreateMatch:e.leagues.currentMembership&&"admin"==e.leagues.currentMembership.role}})(function(e){var t=e.canCreateMatch;return f.a.createElement("div",{className:"matches"},f.a.createElement("div",{className:"columns"},f.a.createElement("div",{className:"column is-two-thirds"},f.a.createElement(De,null)),t&&f.a.createElement("div",{className:"column is-one-third"},f.a.createElement("h2",null,"Record a match"),f.a.createElement(xe,null))))}),Re=n(43),Ue=Object(Re.a)(function(e){var t=e.location,n=e.history,r=e.league,a=e.current,l=e.setLeague;return f.a.createElement("li",{key:r.id,className:"league "+(r.id==a?"current":"")},f.a.createElement("span",{onClick:function(){return l(r.id,a,t,n)}},r.name))}),Ge=Object(l.b)(function(e){return{leagues:e.leagues.all,leagueId:e.leagues.current}},function(l){return{setLeague:function(e,t,n,r){if(e!=t){l(T(e));var a=n.state;a&&a.from&&r.push(a.from)}}}})(function(e){var t=e.leagues,n=e.leagueId,r=e.setLeague;return f.a.createElement("ul",{className:"league-list"},(t||[]).map(function(e){return f.a.createElement(Ue,{key:e.id,league:e,current:n,setLeague:r})}))}),He=function(){return f.a.createElement("div",{className:"league-selector"},f.a.createElement("h2",{className:"subtitle"},"Select a league"),f.a.createElement("br",null),f.a.createElement(Ge,null))},qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ve=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var ze=f.a.memo(function(e){var t=e.onChange,n=e.sport,r=e.sports;return f.a.createElement(ee,null,f.a.createElement("select",{required:"required",name:"sport_id",value:n,onChange:t},f.a.createElement("option",{value:"",disabled:"disabled"},"Select a sport"),(r||[]).map(function(e){return f.a.createElement("option",{key:e.id,value:e.id},e.name)})))}),Be={members_only:!1,name:"",description:"",sport_id:"",domain:""},Je=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=Be,e.handleChange=e.handleChange.bind(e),e.handleSubmit=e.handleSubmit.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["PureComponent"]),Ve(t,[{key:"componentDidMount",value:function(){this.props.sports||this.props.loadSports()}},{key:"handleChange",value:function(e){var t,n,r,a="checkbox"===e.target.type?e.target.checked:e.target.value;"sport_id"==e.target.name&&(a=parseInt(a)),this.setState((t={},n=e.target.name,r=a,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=qe({},this.state,{description:this.state.description||null,domain:this.state.domain||null});this.props.createLeague(t),this.setState(Be)}},{key:"isDisabled",value:function(){return!(this.state.name&&this.state.sport_id)}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.description,r=e.domain,a=e.members_only,l=e.sport_id;return f.a.createElement("form",{onSubmit:this.handleSubmit},f.a.createElement(ee,{description:"Name"},f.a.createElement("input",{type:"text",className:"input is-primary",name:"name",required:"required",placeholder:"Enter the league name",value:t,onChange:this.handleChange})),f.a.createElement(ee,{description:"Description (optional)"},f.a.createElement("textarea",{className:"textarea",name:"description",placeholder:"Description of this league",value:n,onChange:this.handleChange})),f.a.createElement(ee,{description:"Domain restriction (optional)"},f.a.createElement("input",{type:"text",className:"input is-primary",name:"domain",placeholder:"Members' emails must be @ this domain",value:r,onChange:this.handleChange})),f.a.createElement(ee,{description:"Members Only"},f.a.createElement("input",{type:"checkbox",name:"members_only",checked:a,onChange:this.handleChange})),f.a.createElement(ze,{sport:l,onChange:this.handleChange,sports:this.props.sports}),f.a.createElement("button",{type:"submit",disabled:this.isDisabled(),className:"button is-primary"},"Create League"))}}]),t}(),We=Object(l.b)(function(e){return{sports:e.sports}},function(t){return{loadSports:function(){return t(R())},createLeague:function(e){return t(M(e))}}})(Je),Fe=Object(l.b)(function(e){return{canCreateLeague:!!e.userContext.currentUser}})(function(e){var t=e.canCreateLeague,n=e.location,r=e.history;return f.a.createElement("div",{className:"leagues"},f.a.createElement("div",{className:"columns"},f.a.createElement("div",{className:"column is-two-thirds"},f.a.createElement(He,{location:n,history:r})),t&&f.a.createElement("div",{className:"column is-one-third"},f.a.createElement("h2",null,"Start a new league"),f.a.createElement(We,null))))}),Ye=Object(l.b)(function(e){return{leagues:e.leagues,user:e.userContext.currentUser}},function(t){return{joinLeague:function(e){return t((n=e,function(t,e){return N("/api/league_memberships",{player_id:e().userContext.currentUser.id,league_id:n},e,t).then(function(e){t(A(e)),t(I()),t(S())})}));var n}}})(function(e){var t=e.joinLeague,n=e.leagues,r=e.user;return null!=n.all&&n.current&&r&&!n.currentMembership?f.a.createElement("div",{className:"join-league",onClick:function(){return t(n.current)}},"Join this league"):null}),Ke=Object(l.b)(function(e){return{isLoading:0<e.loading.numPending}})(function(e){return e.isLoading?f.a.createElement("div",{className:"loader"},"Loading..."):null}),Qe=Object(l.b)(function(e){return{isLoading:0<e.loading.numPending}})(function(e){var t=e.isLoading,n=e.children;return f.a.createElement(r.Fragment,null,f.a.createElement("div",{className:"container "+(t?"fade-out":"fade-in")},n),f.a.createElement(Ke,null))}),Xe=n(44),Ze=Object(l.b)(function(e){return{all:e.leagues.all,current:e.leagues.current}})(function(e){var t=e.all,n=e.current;if(null!=t){var r=t.find(function(e){return e.id==n});if(null!=r)return f.a.createElement("span",null,"Current League: ",r.name)}return null}),$e=Object(Re.a)(function(e){var t=e.location;return f.a.createElement(Xe.a,{to:{pathname:"/leagues",state:{from:t.pathname}},activeClassName:"hidden"},"Change League")}),et=f.a.memo(function(){return f.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},f.a.createElement("a",{className:"navbar-link"},f.a.createElement(Ze,null)),f.a.createElement("div",{className:"navbar-dropdown"},f.a.createElement($e,null)))}),tt=n(16),nt=function(e){console.warn(e.error)},rt=Object(l.b)(function(e){return{user:e.userContext.currentUser}},function(t){return{googleAuth:function(e){return t((n=e.tokenId,function(t,e){return N("/api/users",{token:n},e,t).then(function(e){e.player&&null==e.error?t(U(e.player)):console.error("Error signing in: "+e.error)})}));var n},signOut:function(){return t(function(e){e({type:g}),fetch("/api/sessions/current",{method:"DELETE"})})}}})(function(e){var t=e.user,n=e.googleAuth,r=e.signOut;return t?f.a.createElement(tt.GoogleLogout,{buttonText:"Logout",onLogoutSuccess:r}):f.a.createElement(tt.GoogleLogin,{clientId:"985074612801-rir5ouc3r4e7kaq6u25j1c12bko24rqq.apps.googleusercontent.com",buttonText:"Login with Google",onSuccess:n,onFailure:nt})}),at=Object(l.b)(function(e){return{user:e.userContext.currentUser}})(function(e){var t=e.user;return t?t.name:"Not logged in."}),lt=function(){return f.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},f.a.createElement("a",{className:"navbar-link"},f.a.createElement(at,null)),f.a.createElement("div",{className:"navbar-dropdown"},f.a.createElement(rt,null)))},ot=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var it=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={burgerized:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f.a.Component),ot(t,[{key:"toggleBurger",value:function(){this.setState({burgerized:!this.state.burgerized})}},{key:"render",value:function(){var e=this.state.burgerized;return f.a.createElement("nav",{className:"navbar",role:"navigation","aria-label":"main navigation"},f.a.createElement("div",{className:"navbar-brand"},f.a.createElement("a",{className:"navbar-item",href:"/"},f.a.createElement("img",{src:"/logo.png",width:"80",height:"28"})),f.a.createElement("a",{role:"button",className:"navbar-burger burger"+(e?" is-active":""),"aria-label":"menu","aria-expanded":"false",onClick:this.toggleBurger.bind(this)},f.a.createElement("span",{"aria-hidden":"true"}),f.a.createElement("span",{"aria-hidden":"true"}),f.a.createElement("span",{"aria-hidden":"true"}))),f.a.createElement("div",{className:"navbar-menu"+(e?" is-active":"")},f.a.createElement("div",{className:"navbar-start"},f.a.createElement(Xe.a,{exact:!0,to:"/",className:"navbar-item",activeClassName:"is-active"},"Overview"),f.a.createElement(Xe.a,{to:"/players",className:"navbar-item",activeClassName:"is-active"},"Players"),f.a.createElement(Xe.a,{to:"/matches",className:"navbar-item",activeClassName:"is-active"},"Matches")),f.a.createElement("div",{className:"navbar-end"},f.a.createElement(lt,null),f.a.createElement(et,null))))}}]),t}(),ct=(n(39),n(40),function(){return f.a.createElement(Qe,null,f.a.createElement(Ye,null),f.a.createElement(it,null),f.a.createElement(Y.a,null,f.a.createElement($,{exact:!0,path:"/players",component:ie}),f.a.createElement($,{path:"/players/:playerId",component:Oe}),f.a.createElement($,{path:"/matches",component:Me}),f.a.createElement($,{exact:!0,path:"/",component:_e}),f.a.createElement(K.a,{path:"/leagues",component:Fe})))}),ut=function(){return f.a.createElement(Q.a,null,f.a.createElement(ct,null))};Object(a.render)(f.a.createElement(l.a,{store:F},f.a.createElement(ut,null)),document.getElementById("app"))}});